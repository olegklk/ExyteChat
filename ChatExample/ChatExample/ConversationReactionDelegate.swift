//
//  ConversationReactionDelegate.swift
//  ChatExample
//
//  Created by AI on 2024-05-24.
//

import Foundation
import ExyteChat

/// ะะปะฐัั, ัะตะฐะปะธะทัััะธะน ะฟัะพัะพะบะพะป ReactionDelegate ะธะท ExyteChat ะดะปั ะฝะฐัััะพะนะบะธ ะปะพะณะธะบะธ ัะตะฐะบัะธะน ะฒ ัะฐัะต.
/// ะะฝ ัะฒัะทัะฒะฐะตั UI-ะบะพะผะฟะพะฝะตะฝัั ExyteChat ั ะฑะธะทะฝะตั-ะปะพะณะธะบะพะน ะฒะฐัะตะณะพ ะฟัะธะปะพะถะตะฝะธั (ConversationViewModel).
class ConversationReactionDelegate: ReactionDelegate {
    
    // ะกะปะฐะฑะฐั ัััะปะบะฐ ะฝะฐ ViewModel, ััะพะฑั ะธะทะฑะตะถะฐัั ัะธะบะปะธัะตัะบะธั ัััะปะพะบ.
    private weak var viewModel: ConversationViewModel?

    init(viewModel: ConversationViewModel) {
        self.viewModel = viewModel
    }

    /// ะัะทัะฒะฐะตััั, ะบะพะณะดะฐ ะฟะพะปัะทะพะฒะฐัะตะปั ะฒัะฑะธัะฐะตั ัะตะฐะบัะธั ะดะปั ัะพะพะฑัะตะฝะธั.
    /// - Parameters:
    ///   - message: ะกะพะพะฑัะตะฝะธะต, ะฝะฐ ะบะพัะพัะพะต ะพััะตะฐะณะธัะพะฒะฐะปะธ.
    ///   - reaction: ะกะพะทะดะฐะฝะฝัะน ัะตัะฝะพะฒะธะบ ัะตะฐะบัะธะธ ะดะปั ะพัะฟัะฐะฒะบะธ ะฝะฐ ัะตัะฒะตั.
    func didReact(to message: Message, reaction: DraftReaction) {
        print("Delegate: ะะพะปัะทะพะฒะฐัะตะปั ะฒัะฑัะฐะป ัะตะฐะบัะธั '\(reaction.type.toString)' ะดะปั ัะพะพะฑัะตะฝะธั '\(message.id)'")
        // ะะตัะตะดะฐะตะผ ะดะตะนััะฒะธะต ะฒ ViewModel ะดะปั ะดะฐะปัะฝะตะนัะตะน ะพะฑัะฐะฑะพัะบะธ (ะฝะฐะฟัะธะผะตั, ะพัะฟัะฐะฒะบะธ ะฝะฐ ัะตัะฒะตั).
        viewModel?.handleReaction(reaction: reaction, for: message.id)
    }

    /// ะะฟัะตะดะตะปัะตั, ะผะพะถะฝะพ ะปะธ ััะฐะฒะธัั ัะตะฐะบัะธะธ ะฝะฐ ะดะฐะฝะฝะพะต ัะพะพะฑัะตะฝะธะต.
    func canReact(to message: Message) -> Bool {
        // ะะพะบะฐ ัะฐะทัะตัะฐะตะผ ัะตะฐะณะธัะพะฒะฐัั ะฝะฐ ะปัะฑัะต ัะพะพะฑัะตะฝะธั.
        // ะะดะตัั ะผะพะถะฝะพ ะดะพะฑะฐะฒะธัั ัะปะพะถะฝัั ะปะพะณะธะบั (ะฝะฐะฟัะธะผะตั, ะทะฐะฟัะตั ะฝะฐ ััะฐััะต ัะพะพะฑัะตะฝะธั).
        return true
    }

    /// ะะฟัะตะดะตะปัะตั, ะฝัะถะฝะพ ะปะธ ะฟะพะบะฐะทัะฒะฐัั ัะฟะธัะพะบ ัะตะฐะบัะธะน ะฟะพะด ัะพะพะฑัะตะฝะธะตะผ.
    func shouldShowOverview(for message: Message) -> Bool {
        // ะะพะบะฐะทัะฒะฐะตะผ ะพะฑะทะพั, ะตัะปะธ ั ัะพะพะฑัะตะฝะธั ะตััั ัะพัั ะฑั ะพะดะฝะฐ ัะตะฐะบัะธั.
        return !message.reactions.isEmpty
    }

    /// ะะฟัะตะดะตะปัะตั, ะดะพัััะฟะตะฝ ะปะธ ะฟะพะธัะบ ะฟะพ ัะผะพะดะทะธ ะฟัะธ ะฒัะฑะพัะต ัะตะฐะบัะธะธ.
    func allowEmojiSearch(for message: Message) -> Bool {
        // ะะฐะทัะตัะฐะตะผ ะฟะพะธัะบ ะฟะพ ัะผะพะดะทะธ.
        return true
    }

    /// ะัะตะดะพััะฐะฒะปัะตั ะฝะฐะฑะพั ะฑัััััั ัะตะฐะบัะธะน, ะบะพัะพััะต ะฑัะดัั ะฟะพะบะฐะทะฐะฝั ะฟะพะปัะทะพะฒะฐัะตะปั.
    func reactions(for message: Message) -> [ReactionType]? {
        // ะกัะฐะฝะดะฐััะฝัะน ะฝะฐะฑะพั ัะผะพะดะทะธ ะดะปั ะฑัััััั ัะตะฐะบัะธะน.
        return [
            .emoji("๐"),
            .emoji("โค๏ธ"),
            .emoji("๐"),
            .emoji("๐ฎ"),
            .emoji("๐ข"),
            .emoji("๐ก")
        ]
    }
}
